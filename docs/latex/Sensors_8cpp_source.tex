\hypertarget{Sensors_8cpp_source}{}\section{Sensors.\+cpp}
\label{Sensors_8cpp_source}\index{/home/soobin/\+Documents/\+Sandbox/\+I\+G\+V/src/\+Sensors.\+cpp@{/home/soobin/\+Documents/\+Sandbox/\+I\+G\+V/src/\+Sensors.\+cpp}}

\begin{DoxyCode}
00001 \textcolor{preprocessor}{#}\textcolor{preprocessor}{include} \textcolor{preprocessor}{"Sensors.hpp"}
00002 
00003 \textcolor{preprocessor}{#}\textcolor{preprocessor}{ifndef} \textcolor{preprocessor}{SIMULATION}
00004 \textcolor{keyword}{using} \textcolor{keyword}{namespace} mn::CppLinuxSerial;
00005 \textcolor{keyword}{using} \textcolor{keyword}{namespace} igv;
00006 
00007 \textcolor{keywordtype}{void} Magno::Probe()\{
00008 
00009 \}
00010 
00011 
00012 UltraSonic::UltraSonic()\{
00013 
00014     GPIO::setmode(GPIO::BOARD);
00015 
00016     GPIO::setup(ULTRA\_IN, GPIO::IN);
00017     GPIO::setup(ULTRA\_OUT, GPIO::OUT, GPIO::LOW);
00018 
00019 \}
00020 
00021 \textcolor{keywordtype}{void} UltraSonic::Probe() \{
00022 
00023     busy = \textcolor{keyword}{true};
00024 
00025     GPIO::output(ULTRA\_OUT, GPIO::HIGH);  \textcolor{comment}{// trigger a pulse}
00026     \textcolor{keyword}{auto} start = std::chrono::system\_clock::now();  \textcolor{comment}{// get the current time}
00027     \textcolor{keywordflow}{while}(!GPIO::input(ULTRA\_IN));  \textcolor{comment}{// wait for a signal on the input line}
00028     \textcolor{keyword}{auto} end = std::chrono::system\_clock::now();  \textcolor{comment}{// get the current time}
00029 
00030     std::chrono::duration<\textcolor{keywordtype}{double}> timediff = end - start; \textcolor{comment}{// calculate the difference}
00031 
00032     \textcolor{keyword}{this}->distance = VSOUND\_D2*timediff.count(); \textcolor{comment}{// v = d/t -> d = v*t: t = timediff/2, v = speed of
       sound}
00033     GPIO::output(ULTRA\_OUT, GPIO::LOW);  \textcolor{comment}{// reset}
00034 
00035     busy = \textcolor{keyword}{false};
00036 
00037 \}
00038 
00039 
00040 \textcolor{preprocessor}{#}\textcolor{preprocessor}{else}
00041 
00042 
00043 \textcolor{preprocessor}{#}\textcolor{preprocessor}{endif}
\end{DoxyCode}
